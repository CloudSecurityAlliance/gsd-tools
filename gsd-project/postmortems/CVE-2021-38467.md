# Postmortem on CVE-2021-38467

While reviewing CVEs I ran across CVE-2021-38467 which has a number of problems

## Lack of vendor, product, vulnerability and fixed data:

The CVE text description reads:

> A specific function code receives a raw pointer supplied by the user and deallocates this pointer. The user can then control what memory regions will be freed and cause use-after-free condition.

I was under the impression that the text description must include this data (CVE CNA rules 2.0 https://cve.mitre.org/cve/cna/CNA_Rules_v2.0.pdf specifically "Appendix B CVE Information Format") 

This is no longer the case, under the CVE CNA rules 3.0 (https://cve.mitre.org/cve/cna/rules.html specifically "8.2 Prose Description Requirements") this is no longer the case:

> 8.2.1 MUST provide enough information for a reader to have a reasonable understanding of what products are affected. If the affected products are not explicitly listed in the description, then the CNA MUST provide a reference that points to the known affected products.

> 8.2.2 SHOULD include the affected or fixed version(s).

> 8.2.3 MUST include one of the following:

> Vulnerability Type
> Root Cause
> Impact

As such the text description with no vendor, product or affected version is allowed.

## Information about affected version

Obviously which product and version are affected by a CVE are a central and critical issue (is this a Windows issue? Apache? Some OpenSource library? A commercial product?). 

Also the version affected is critical, are you running an affected version? Do you need to upgrade, and if so to what version specifically?

### https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-38467

No data, you must click original reference to find it

AFFECTED: "NO DATA"
FIXED: "NO DATA"

### https://www.cve.org/CVERecord?id=CVE-2021-38467

> Vendor: AUVESY
> Product: Versiondog
> Versions Affected:
> <=8.0: affects 8.0 and prior versions

Note the web page includes the JSON, but it is not displayed by default

AFFECTED: "<=8.0"
FIXED: ">=8.1" (you must manually open and read the JSON data)

### https://github.com/CVEProject/cvelist/blob/master/2021/38xxx/CVE-2021-38467.json

The JSON data says:

> {
>   "vendor": {
>     "vendor_data": [
>       {
>         "vendor_name": "AUVESY",
>         "product": {
>           "product_data": [
>             {
>               "product_name": "Versiondog",
>               "version": {
>                 "version_data": [
>                   {
>                     "version_affected": "<=",
>                     "version_name": "All",
>                     "version_value": "8.0"

and later on:

>    "solution": [
>        {
>            "lang": "eng",
>            "value": "AUVESY recommends upgrading Versiondog to Version 8.1 or later (login required)."
            
AFFECTED: "<=8.0.0"
FIXED: ">=8.1"

### https://nvd.nist.gov/vuln/detail/CVE-2021-38467

The CPE data says:

> cpe:2.3:a:auvesy:versiondog:*:*:*:*:*:*:*:*
> Up to (excluding)
> 8.0.0

AFFECTED: "<8.0.0"
FIXED: "NO DATA"

### https://us-cert.cisa.gov/ics/advisories/icsa-21-292-01

The original report says:

> 3.1 AFFECTED PRODUCTS
> The following versions of Versiondog, a data management software for automated production, are affected:
> Versiondog: All versions prior to v8.0

But it also says later on:

> 4. MITIGATIONS
> AUVESY recommends upgrading Versiondog to Version 8.1 or later (login required).

AFFECTED: "<8.0"
FIXED: ">=8.1" 

## Conclusion about product/version affected

Based on the original source material form CISA:

Versiondog prior to 8.0 is definitely affected.

Versiondog 8.1 and later are definitely fixed.

Verisondog 8.0 is probably vulnerable, but we can't be sure, someone needs to contact CISA, clarify this, and update the CVE.

Verisondog 8.0.0 is probably vulnerable, but we can't be sure, someone needs to contact CISA, clarify this, and update the CVE. It is probably the same as 8.0.

Based on the data from Mitre/NVD/etc. it's clear that there are problems in the parsing and interpretation of the data and that original source data is not being checked or verified.

Based on the CISA and CVE/JSON data it's clear that CISA/MITRE has some mismatch in the source data and the CVE data.

## Recommendations:

1. Have a feedback method to indicate there is a problem
2. Have a feedback method to provide feedback on the problem
3. Have a feedback method to provide a solution for the problem (if applicable)
4. Provide links to contact original vulnerability reporter, vulnerability id requestor, and source material reporter, direct links (e.g. mailto) will result in a lack of transparency and no idea if the person has been contacted or not, so some form of ticketing system that also pushes out email/etc.
